# GalGame Framework

一个在 Minecraft 中实现 GalGame（视觉小说）游戏的框架模组。玩家可以导入自定义内容包，在游戏中体验完整的视觉小说游戏。

## 安装说明

### 开发环境设置

这个模板仓库可以直接克隆来开始新的模组开发。按照 [GitHub](https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template) 提供的说明创建新仓库。

克隆后，在您选择的 IDE 中打开仓库。推荐使用 IntelliJ IDEA 或 Eclipse。

如果 IDE 中缺少库或遇到问题，可以运行：
- `gradlew --refresh-dependencies` - 刷新本地缓存
- `gradlew clean` - 重置所有内容（不影响代码），然后重新开始

### 映射名称

默认情况下，MDK 配置为使用 Mojang 的官方映射名称。这些名称受特定许可证保护。所有模组开发者都应该了解此许可证。最新许可证文本请参考映射文件本身，或参考：https://github.com/NeoForged/NeoForm/blob/main/Mojang.md

### 其他资源

- 社区文档: https://docs.neoforged.net/
- NeoForged Discord: https://discord.neoforged.net/

---

## 功能规划

### 🎮 核心游戏系统

#### 1. 对话系统
- **文本显示系统**
  - 支持多行文本显示
  - 打字机效果（逐字显示）
  - 文本自动换行和滚动
  - 支持富文本格式（颜色、粗体、斜体等）
  - 多语言支持（i18n）

- **角色系统**
  - 角色立绘显示（支持多位置：左、中、右）
  - 角色表情切换（高兴、悲伤、愤怒等）
  - 角色名称显示
  - 角色立绘淡入淡出动画
  - 立绘位置和缩放控制

- **对话控制**
  - 点击/按键继续对话
  - 对话历史记录查看
  - 对话快进功能
  - 对话跳过（已读/未读标记）

#### 2. 选择分支系统
- **选项显示**
  - 多选项分支（2-6个选项）
  - 选项条件判断（基于游戏变量）
  - 选项显示/隐藏控制
  - 选项高亮和选择动画

- **分支逻辑**
  - 条件分支（if/else）
  - 变量判断（数值、字符串、布尔值）
  - 多条件组合（AND/OR）
  - 跳转标签系统

#### 3. 存档/读档系统
- **存档管理**
  - 多存档槽位（建议 10-20 个）
  - 自动存档功能
  - 存档截图预览
  - 存档时间戳和游戏进度信息
  - 存档加密/验证

- **读档功能**
  - 存档列表界面
  - 存档加载确认
  - 存档损坏检测和恢复
  - 跨世界存档支持

#### 4. 视觉系统
- **背景管理**
  - 背景图片切换
  - 背景淡入淡出过渡
  - 背景动画支持（静态/动态）
  - 背景模糊/特效

- **UI 界面**
  - 可自定义的对话框样式
  - 半透明/毛玻璃效果
  - UI 主题切换
  - 界面元素动画（淡入、滑动等）

#### 5. 音频系统
- **背景音乐（BGM）**
  - BGM 播放/暂停/停止
  - BGM 淡入淡出
  - BGM 循环播放
  - 多轨道 BGM 切换
  - BGM 音量控制

- **音效（SE）**
  - 点击音效
  - 选项选择音效
  - 场景切换音效
  - 音效音量控制
  - 3D 音效定位（可选）

- **语音（Voice）**
  - 角色语音播放
  - 语音字幕显示
  - 语音跳过控制
  - 语音音量独立控制

### 📦 内容包系统

#### 1. 内容包格式
- **包结构定义**
  - 标准化的文件夹结构
  - 清单文件（manifest.json/toml）
  - 资源文件组织（图片、音频、脚本）
  - 版本控制和兼容性检查

- **脚本系统**
  - 脚本语言定义（JSON/YAML/自定义 DSL）
  - 脚本解析器
  - 脚本验证和错误检查
  - 脚本热重载（开发模式）

#### 2. 内容包加载器
- **包管理**
  - 内容包扫描和发现
  - 内容包加载和初始化
  - 内容包依赖管理
  - 内容包冲突检测和解决

- **资源加载**
  - 图片资源加载（PNG、JPG、WebP）
  - 音频资源加载（OGG、MP3、WAV）
  - 资源缓存和优化
  - 资源预加载

#### 3. 内容包管理界面
- **包管理 UI**
  - 已安装内容包列表
  - 内容包启用/禁用
  - 内容包信息查看（作者、版本、描述）
  - 内容包卸载
  - 内容包导入（拖放或文件选择）

- **包验证**
  - 内容包完整性检查
  - 资源文件验证
  - 脚本语法检查
  - 兼容性警告

### 💾 数据系统

#### 1. 游戏进度管理
- **变量系统**
  - 全局变量存储
  - 局部变量（场景内）
  - 变量类型（整数、浮点数、字符串、布尔值）
  - 变量持久化

- **游戏状态**
  - 当前场景/章节跟踪
  - 已读标记
  - 成就进度
  - 统计数据

#### 2. 成就系统
- **成就定义**
  - 成就条件设置
  - 成就图标和描述
  - 成就解锁通知
  - 成就统计

#### 3. 统计系统
- **游戏统计**
  - 游戏时长统计
  - 对话数量统计
  - 选择分支统计
  - 完成度计算

### 🎨 UI/UX 系统

#### 1. 游戏界面
- **对话界面**
  - 对话框显示
  - 角色名称显示
  - 选项按钮
  - 快捷菜单按钮

- **菜单界面**
  - 主菜单（开始游戏、继续、设置、退出）
  - 游戏内菜单（存档、读档、设置、返回）
  - 设置菜单（音量、显示、控制）

- **存档界面**
  - 存档槽位网格显示
  - 存档预览和信息
  - 存档操作（保存、加载、删除）

#### 2. 设置系统
- **显示设置**
  - 分辨率设置
  - 全屏/窗口模式
  - UI 缩放
  - 文字大小调整

- **音频设置**
  - 主音量
  - BGM 音量
  - SE 音量
  - 语音音量

- **控制设置**
  - 快捷键自定义
  - 鼠标/触摸控制
  - 自动播放速度

#### 3. 动画系统
- **过渡动画**
  - 场景切换动画
  - 立绘出现/消失动画
  - UI 元素动画
  - 自定义动画支持

### 🔧 集成功能

#### 1. Minecraft 世界集成
- **世界交互**
  - 在特定位置触发 GalGame
  - 与 NPC/实体交互启动游戏
  - 物品/方块触发游戏
  - 世界事件触发

- **场景系统**
  - 3D 场景与 2D 背景结合
  - 玩家视角控制
  - 场景切换效果

#### 2. 多人游戏支持
- **同步系统**
  - 多人游戏进度同步
  - 共享存档
  - 同步播放控制

#### 3. 扩展 API
- **开发者 API**
  - 内容包开发 API
  - 脚本系统 API
  - 事件系统 API
  - 自定义 UI 组件 API

### 🛠️ 开发工具

#### 1. 内容包开发工具
- **编辑器支持**
  - 脚本编辑器
  - 资源管理器
  - 预览工具
  - 调试工具

#### 2. 调试功能
- **开发模式**
  - 脚本调试器
  - 变量监视器
  - 性能分析
  - 日志系统

---

## 技术架构

### 核心技术栈
- **语言**: Kotlin
- **框架**: NeoForge 1.21.10
- **UI 系统**: Minecraft 原生 GUI + 自定义渲染
- **脚本系统**: JSON/YAML 配置 + Kotlin DSL
- **资源格式**: PNG/WebP（图片）、OGG（音频）

### 模块划分
- `core` - 核心游戏引擎
- `ui` - 用户界面系统
- `content` - 内容包加载和管理
- `script` - 脚本解析和执行
- `audio` - 音频播放系统
- `save` - 存档系统
- `api` - 开发者 API

---

## 内容包开发指南

### 内容包结构示例
```
content_pack/
├── manifest.json          # 包信息
├── scripts/               # 游戏脚本
│   ├── chapter1.json
│   └── chapter2.json
├── images/                # 图片资源
│   ├── backgrounds/       # 背景
│   ├── characters/       # 角色立绘
│   └── ui/               # UI 元素
└── audio/                # 音频资源
    ├── bgm/              # 背景音乐
    └── se/                # 音效
```

### 脚本格式示例
```json
{
  "scenes": [
    {
      "id": "scene_001",
      "background": "images/backgrounds/scene1.png",
      "bgm": "audio/bgm/title.ogg",
      "dialogue": [
        {
          "character": "主角",
          "text": "这是第一句对话",
          "expression": "normal",
          "position": "left"
        }
      ],
      "choices": [
        {
          "text": "选项1",
          "condition": "flag1 == true",
          "goto": "scene_002"
        }
      ]
    }
  ]
}
```

---

## 开发路线图

### Phase 1: 核心功能（MVP）
- [x] 项目框架搭建
- [ ] 基础对话系统
- [ ] 简单的 UI 界面
- [ ] 基础内容包加载
- [ ] 存档/读档系统

### Phase 2: 完善功能
- [ ] 选择分支系统
- [ ] 音频系统
- [ ] 动画系统
- [ ] 内容包管理界面

### Phase 3: 高级功能
- [ ] 成就系统
- [ ] 统计系统
- [ ] 多人游戏支持
- [ ] 开发者 API

### Phase 4: 优化和扩展
- [ ] 性能优化
- [ ] 内容包开发工具
- [ ] 社区功能
- [ ] 模组集成

---

## 贡献指南

欢迎贡献代码、报告问题或提出建议！

## 许可证

All Rights Reserved

---

**Ciallo～(∠・ω< )⌒★**
